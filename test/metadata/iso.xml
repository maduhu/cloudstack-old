<isotest>

<!--  Test case 869 - admin attaching iso to user's vm -->
	<command>
		<name>createUser</name>
		<parameters>
			<item random="true" setparam="true">
			    <name>username</name>
			    <param>usernameparam</param>
			</item>
			<item>
			    <name>password</name>
				<value>alena123</value>
			</item>
			<item>
				<name>firstname</name>
				<value>admin</value>
			</item>
			<item>
				<name>lastname</name>
				<value>adminlastname</value>
			</item>
			<item>
				<name>email</name>
				<value>admin@gmail.com</value>
			</item>
			<item>
				<name>accounttype</name>
				<value>0</value>
			</item>
		</parameters>
		<returnvalue>
			<item setparam="true">
				<name>account</name>
				<param>accountname</param>
			</item>
		</returnvalue>
	</command>
	
	<command>
		<name>deployVirtualMachine</name>
		<parameters>
			<item getparam="true">
			    <name>zoneid</name>
				<param>globalzoneid</param>
			</item>
			<item>
			    <name>serviceofferingid</name>
				<value>1</value>
			</item>
			<item>
			    <name>diskofferingid</name>
				<value>1</value>
			</item>	
			<item getparam="true">
				<name>templateid</name>
				<param>globaltemplateid</param>
			</item>
			<item getparam="true">
				<name>account</name>
				<param>accountname</param>
			</item>
			<item>
				<name>displayname</name>
				<value>namefordisplay</value>
			</item>
			<item>
				<name>group</name>
				<value>group1</value>
			</item>
		</parameters>
		<returnvalue>
			<item setparam="true">
				<name>id</name>
				<param>vmid</param>
			</item>
		</returnvalue>
	</command>
	
	<command>
		<name>attachIso</name>
		<testcase>869-1</testcase>
		<parameters>
			<item getparam="true">
			    <name>virtualmachineid</name>
				<param>vmid</param>
			</item>
			<item getparam="true">
			    <name>id</name>
				<param>globalisoid</param>
			</item>
		</parameters>
	</command>
	
	<command>
		<name>listVirtualMachines</name>
		<testcase>869-2</testcase>
		<parameters>
			<item getparam="true">
				<name>id</name>
				<param>vmid</param>
			</item>
		</parameters>
		<returnvalue>
			<item getparam="true">
				<name>isoid</name>
				<param>globalisoid</param>
			</item>
		</returnvalue>
	</command>
	
	
<!--  Test case 870 - verify that user2 can't attach iso to user2 vm - Negative case -->
	<command>
		<name>createUser</name>
		<parameters>
			<item random="true">
			    <name>username</name>
			</item>
			<item>
			    <name>password</name>
				<value>apiuser</value>
			</item>
			<item>
				<name>firstname</name>
				<value>apiuser</value>
			</item>
			<item>
				<name>lastname</name>
				<value>apiuser</value>
			</item>
			<item>
				<name>email</name>
				<value>apiuser@gmail.com</value>
			</item>
			<item>
				<name>accounttype</name>
				<value>0</value>
			</item>
		</parameters>
		<returnvalue>
			<item setparam="true">
				<name>id</name>
				<param>userid</param>
			</item>
			<item setparam="true">
				<name>username</name>
				<param>usernamevar</param>
			</item>
			<item setparam="true">
				<name>account</name>
				<param>accountvar</param>
			</item>
		</returnvalue>
	</command>
	
	<command>
		<name>register</name>
		<parameters>
			<item getparam="true">
			    <name>username</name>
				<param>usernamevar</param>
			</item>
			<item>
			    <name>domainid</name>
				<value>1</value>
			</item>
		</parameters>
		<returnvalue>
			<item setparam="true">
				<name>apikey</name>
				<param>apikey</param>
			</item>
			<item setparam="true">
				<name>secretkey</name>
				<param>secretkey</param>
			</item>
		</returnvalue>
	</command>		
	
	<command>
		<name>attachIso</name>
		<usercommand>true</usercommand>
		<testcase>870</testcase>
		<error>true</error>
		<parameters>
			<item getparam="true">
			    <name>virtualmachineid</name>
				<param>vmid</param>
			</item>
			<item getparam="true">
			    <name>id</name>
				<param>globalisoid</param>
			</item>
		</parameters>
	</command>
	
	
<!--  Test case 871 - try to attach iso to the vm in destroyed state - Negative case -->	
	<command>
		<name>destroyVirtualMachine</name>
		<parameters>
			<item getparam="true">
				<name>id</name>
				<param>vmid</param>
			</item>
		</parameters>
	</command>
	
	<command>
		<name>attachIso</name>
		<testcase>871</testcase>
		<error>true</error>
		<parameters>
			<item getparam="true">
			    <name>virtualmachineid</name>
				<param>vmid</param>
			</item>
			<item getparam="true">
			    <name>id</name>
				<param>globalisoid</param>
			</item>
		</parameters>
	</command>
	
	
<!--  Test case 872 - try to attach iso to non-existing vm - Negative case -->
	<command>
		<name>attachIso</name>
		<testcase>872</testcase>
		<error>true</error>
		<parameters>
			<item>
			    <name>virtualmachineid</name>
				<value>600000</value>
			</item>
			<item getparam="true">
			    <name>id</name>
				<param>globalisoid</param>
			</item>
		</parameters>
	</command>
	

<!--  Test case 1073 - attach iso to the running vm and reboot -->
	<command>
		<name>deployVirtualMachine</name>
		<parameters>
			<item getparam="true">
			    <name>zoneid</name>
				<param>globalzoneid</param>
			</item>
			<item>
			    <name>serviceofferingid</name>
				<value>1</value>
			</item>
			<item>
			    <name>diskofferingid</name>
				<value>1</value>
			</item>	
			<item getparam="true">
				<name>templateid</name>
				<param>globaltemplateid</param>
			</item>
			<item getparam="true">
				<name>account</name>
				<param>accountname</param>
			</item>
			<item>
				<name>displayname</name>
				<value>namefordisplay</value>
			</item>
			<item>
				<name>group</name>
				<value>group1</value>
			</item>
		</parameters>
		<returnvalue>
			<item setparam="true">
				<name>id</name>
				<param>vmid</param>
			</item>
		</returnvalue>
	</command>
	
	<command>
		<name>attachIso</name>
		<parameters>
			<item getparam="true">
			    <name>virtualmachineid</name>
				<param>vmid</param>
			</item>
			<item getparam="true">
			    <name>id</name>
				<param>globalisoid</param>
			</item>
		</parameters>
	</command>
	
	<command>
		<name>rebootVirtualMachine</name>
		<testcase>1073-1</testcase>
		<parameters>
			<item getparam="true">
				<name>id</name>
				<param>vmid</param>
			</item>
		</parameters>
	</command>
	
	<command>
		<name>listVirtualMachines</name>
		<testcase>1073-2</testcase>
		<parameters>
			<item getparam="true">
				<name>id</name>
				<param>vmid</param>
			</item>
		</parameters>
		<returnvalue>
			<item getparam="true">
				<name>isoid</name>
				<param>globalisoid</param>
			</item>
		</returnvalue>
	</command>
	
<!--  Test case 1074 - attach iso to the running vm and stop/start -->
	<command>
		<name>stopVirtualMachine</name>
		<testcase>1074-1</testcase>
		<parameters>
			<item getparam="true">
				<name>id</name>
				<param>vmid</param>
			</item>
		</parameters>
	</command>
	
	<command>
		<name>listVirtualMachines</name>
		<testcase>1074-2</testcase>
		<parameters>
			<item getparam="true">
				<name>id</name>
				<param>vmid</param>
			</item>
		</parameters>
		<returnvalue>
			<item getparam="true">
				<name>isoid</name>
				<param>globalisoid</param>
			</item>
		</returnvalue>
	</command>
	
	<command>
		<name>startVirtualMachine</name>
		<testcase>1074-3</testcase>
		<parameters>
			<item getparam="true">
				<name>id</name>
				<param>vmid</param>
			</item>
		</parameters>
	</command>
	
	<command>
		<name>listVirtualMachines</name>
		<testcase>1074-4</testcase>
		<parameters>
			<item getparam="true">
				<name>id</name>
				<param>vmid</param>
			</item>
		</parameters>
		<returnvalue>
			<item getparam="true">
				<name>isoid</name>
				<param>globalisoid</param>
			</item>
		</returnvalue>
	</command>
	
	
<!--  Test case 1075 - try to attach iso to the domR - negative case -->
	<command>
		<name>listRouters</name>
		<testcase>35</testcase>
		<parameters>
			<item getparam="true">
				<name>zoneid</name>
				<param>globalzoneid</param>
			</item>
			<item getparam="true">
				<name>account</name>
				<param>accountname</param>
			</item>
			<item>
				<name>domainid</name>
				<value>1</value>
			</item>
		</parameters>
		<returnvalue list="true">
			<name>router</name>
		    <element>0</element>
			<item setparam="true">
				<name>id</name>
				<param>routerid</param>
			</item>
		</returnvalue>
	</command>	
	
	<command>
		<name>attachIso</name>
		<testcase>1075</testcase>
		<error>true</error>
		<parameters>
			<item getparam="true">
			    <name>virtualmachineid</name>
				<param>routerid</param>
			</item>
			<item getparam="true">
			    <name>id</name>
				<param>globalisoid</param>
			</item>
		</parameters>
	</command>
	
<!--  Test case 1076 - detach iso from Running vm -->
	<command>
		<name>detachIso</name>
		<testcase>1076</testcase>
		<parameters>
			<item getparam="true">
			    <name>virtualmachineid</name>
				<param>vmid</param>
			</item>
		</parameters>
	</command>
	
	
<!--  Test case 1077 - detach iso from Stopped vm -->
	<command>
		<name>attachIso</name>
		<parameters>
			<item getparam="true">
			    <name>virtualmachineid</name>
				<param>vmid</param>
			</item>
			<item getparam="true">
			    <name>id</name>
				<param>globalisoid</param>
			</item>
		</parameters>
	</command>
		
	<command>
		<name>stopVirtualMachine</name>
		<parameters>
			<item getparam="true">
				<name>id</name>
				<param>vmid</param>
			</item>
		</parameters>
	</command>
	
	<command>
		<name>detachIso</name>
		<testcase>1077</testcase>
		<parameters>
			<item getparam="true">
			    <name>virtualmachineid</name>
				<param>vmid</param>
			</item>
		</parameters>
	</command>
	
	
<!--  Test case 1078 - deploy vm from iso -->
	<command>
		<name>deployVirtualMachine</name>
		<testcase>1078</testcase>
		<parameters>
			<item getparam="true">
			    <name>zoneid</name>
				<param>globalzoneid</param>
			</item>
			<item>
			    <name>serviceofferingid</name>
				<value>1</value>
			</item>
			<item>
			    <name>diskofferingid</name>
				<value>1</value>
			</item>	
			<item getparam="true">
				<name>templateid</name>
				<param>globalisoid</param>
			</item>
			<item getparam="true">
				<name>account</name>
				<param>accountname</param>
			</item>
			<item>
				<name>displayname</name>
				<value>namefordisplay</value>
			</item>
			<item>
				<name>group</name>
				<value>group1</value>
			</item>
		</parameters>
		<returnvalue>
			<item setparam="true">
				<name>id</name>
				<param>vmid</param>
			</item>
			<item getparam="true">
				<name>templateid</name>
				<param>globalisoid</param>
			</item>
			<item getparam="true">
				<name>isoid</name>
				<param>globalisoid</param>
			</item>
		</returnvalue>
	</command>
	
<!--  Test case 1079 - deploy vm from iso, detach iso and reboot the vm -->
	<command>
		<name>deployVirtualMachine</name>
		<testcase>1079-1</testcase>
		<parameters>
			<item getparam="true">
			    <name>zoneid</name>
				<param>globalzoneid</param>
			</item>
			<item>
			    <name>serviceofferingid</name>
				<value>1</value>
			</item>
			<item>
			    <name>diskofferingid</name>
				<value>1</value>
			</item>	
			<item getparam="true">
				<name>templateid</name>
				<param>globalisoid</param>
			</item>
			<item getparam="true">
				<name>account</name>
				<param>accountname</param>
			</item>
			<item>
				<name>displayname</name>
				<value>namefordisplay</value>
			</item>
			<item>
				<name>group</name>
				<value>group1</value>
			</item>
		</parameters>
		<returnvalue>
			<item setparam="true">
				<name>id</name>
				<param>vmid</param>
			</item>
			<item getparam="true">
				<name>templateid</name>
				<param>globalisoid</param>
			</item>
		</returnvalue>
	</command>
	
	<command>
		<name>detachIso</name>
		<testcase>1079-2</testcase>
		<parameters>
			<item getparam="true">
			    <name>virtualmachineid</name>
				<param>vmid</param>
			</item>
		</parameters>
	</command>
	
	
	<command>
		<name>rebootVirtualMachine</name>
		<testcase>1079-3</testcase>
		<parameters>
			<item getparam="true">
				<name>id</name>
				<param>vmid</param>
			</item>
		</parameters>
	</command>
	
	
	<command>
		<name>listVirtualMachines</name>
		<testcase>1079-4</testcase>
		<parameters>
			<item getparam="true">
				<name>id</name>
				<param>vmid</param>
			</item>
		</parameters>
		<returnvalue>
			<item getparam="true">
				<name>templateid</name>
				<param>globalisoid</param>
			</item>
		</returnvalue>
	</command>
	
	
	
<!--  Test case 1080 - deploy vm from iso, detach iso and stop/start the vm -->
	<command>
		<name>deployVirtualMachine</name>
		<testcase>1080-1</testcase>
		<parameters>
			<item getparam="true">
			    <name>zoneid</name>
				<param>globalzoneid</param>
			</item>
			<item>
			    <name>serviceofferingid</name>
				<value>1</value>
			</item>
			<item>
			    <name>diskofferingid</name>
				<value>1</value>
			</item>	
			<item getparam="true">
				<name>templateid</name>
				<param>globalisoid</param>
			</item>
			<item getparam="true">
				<name>account</name>
				<param>accountname</param>
			</item>
			<item>
				<name>displayname</name>
				<value>namefordisplay</value>
			</item>
			<item>
				<name>group</name>
				<value>group1</value>
			</item>
		</parameters>
		<returnvalue>
			<item setparam="true">
				<name>id</name>
				<param>vmid</param>
			</item>
			<item getparam="true">
				<name>templateid</name>
				<param>globalisoid</param>
			</item>
		</returnvalue>
	</command>
	
	<command>
		<name>detachIso</name>
		<testcase>1080-2</testcase>
		<parameters>
			<item getparam="true">
			    <name>virtualmachineid</name>
				<param>vmid</param>
			</item>
		</parameters>
	</command>
	
	
	<command>
		<name>stopVirtualMachine</name>
		<testcase>1080-3</testcase>
		<parameters>
			<item getparam="true">
				<name>id</name>
				<param>vmid</param>
			</item>
		</parameters>
	</command>
	
	
	<command>
		<name>startVirtualMachine</name>
		<testcase>1080-4</testcase>
		<parameters>
			<item getparam="true">
				<name>id</name>
				<param>vmid</param>
			</item>
		</parameters>
	</command>
	
	
	<command>
		<name>listVirtualMachines</name>
		<testcase>1080-4</testcase>
		<parameters>
			<item getparam="true">
				<name>id</name>
				<param>vmid</param>
			</item>
		</parameters>
		<returnvalue>
			<item getparam="true">
				<name>templateid</name>
				<param>globalisoid</param>
			</item>
		</returnvalue>
	</command>
	
</isotest>